<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Leap and Learn Editor</title>
    <style>
        :root {
            --accent: #7cf9ff;
            --bg-dark: #0f172a;
        }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; display: flex; height: 100vh; background: #1e293b; color: white; overflow: hidden; }
        
        /* Sidebar Styles */
        #editor-side { width: 400px; background: #0f172a; padding: 20px; overflow-y: auto; border-right: 2px solid var(--accent); }
        .section { margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #334155; }
        h2 { color: var(--accent); font-size: 1.2rem; margin-top: 0; }
        label { display: block; margin: 10px 0 5px; font-size: 0.9rem; opacity: 0.8; }
        input, select, button { width: 100%; padding: 10px; border-radius: 8px; border: none; background: #1e293b; color: white; margin-bottom: 10px; }
        button { background: var(--accent); color: #0f172a; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { filter: brightness(1.2); }
        button.secondary { background: #334155; color: white; }

        /* Preview Styles */
        #preview-side { flex-grow: 1; display: flex; flex-direction: column; background: #000; position: relative; }
        #game-frame { width: 100%; height: 100%; border: none; }
        .toolbar { background: #1e293b; padding: 10px; display: flex; justify-content: space-between; align-items: center; }

        /* Modal for Levels */
        #modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; align-items: center; justify-content: center; }
        .modal-content { background: #0f172a; padding: 30px; border-radius: 20px; width: 80%; max-width: 600px; max-height: 80vh; overflow-y: auto; border: 2px solid var(--accent); }
        .q-item { background: #1e293b; padding: 15px; margin-bottom: 10px; border-radius: 10px; }
    </style>
</head>
<body>

<div id="editor-side">
    <h1 style="color: var(--accent); font-size: 1.5rem;">Leap & Learn <small style="color:white; opacity:0.5">Editor</small></h1>
    
    <div class="section">
        <h2>üé® –í–∏–∑—É–∞–ª</h2>
        <label>–§–æ–Ω –ª–æ–∫–∞—Ü–∏–∏</label>
        <select id="bg-select" onchange="updatePreview()">
            <option value="https://img.genially.com/67961b32a116fb001568a75e/c0c9010f-c3dd-42c1-b7c1-65024fa3aec6.png">–†–µ–∫–∞ (–û–±—ã—á–Ω—ã–π)</option>
            <option value="https://img.genially.com/67961b32a116fb001568a75e/fa2ab459-fec9-4ccd-97e3-254427b4ade0.png">–õ–∞–≤–∞</option>
            <option value="https://img.genially.com/67961b32a116fb001568a75e/02b52ad4-9d31-4b21-a305-8fec6e8a4487.png">–ë–æ–ª–æ—Ç–æ</option>
            <option value="custom">–°–≤–æ–π URL...</option>
        </select>
        <input type="text" id="custom-bg" placeholder="URL —Ñ–æ–Ω–∞" style="display:none" oninput="updatePreview()">

        <label>–ü–µ—Ä—Å–æ–Ω–∞–∂</label>
        <select id="char-select" onchange="updatePreview()">
            <option value="https://img.genially.com/67961b32a116fb001568a75e/3074df22-5c73-4ad2-b0b2-491c6fc247f3.png">–õ—è–≥—É—à–∫–∞</option>
            <option value="https://img.genially.com/67961b32a116fb001568a75e/74b56fcf-5354-43dd-9c9a-f50facc9a9bf.png">–•–∞–º–µ–ª–µ–æ–Ω</option>
            <option value="https://img.genially.com/67961b32a116fb001568a75e/0feda2a1-485a-4654-8640-bf1adcc9f9ec.png">–Ø—â–µ—Ä–∏—Ü–∞</option>
        </select>
    </div>

    <div class="section">
        <h2>üåà –¶–≤–µ—Ç–∞ –∏ –ù–µ–æ–Ω</h2>
        <label>–¶–≤–µ—Ç –ø–∞–Ω–µ–ª–µ–π –∏ —Ç–∞–π–º–µ—Ä–∞</label>
        <input type="color" id="main-color" value="#7cf9ff" onchange="updatePreview()">
        
        <label>–ù–µ–æ–Ω (—Å–≤–µ—á–µ–Ω–∏–µ)</label>
        <select id="neon-toggle" onchange="updatePreview()">
            <option value="yes">–í–∫–ª—é—á–µ–Ω–æ</option>
            <option value="no">–í—ã–∫–ª—é—á–µ–Ω–æ</option>
        </select>

        <label>–¶–≤–µ—Ç —à—Ä–∏—Ñ—Ç–∞</label>
        <input type="color" id="font-color" value="#ffffff" onchange="updatePreview()">
        <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (px)</label>
        <input type="number" id="font-size" value="26" onchange="updatePreview()">
    </div>

    <div class="section">
        <h2>‚öôÔ∏è –ì–µ–π–º–ø–ª–µ–π</h2>
        <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å (—Å–µ–∫ –Ω–∞ –æ—Ç–≤–µ—Ç)</label>
        <input type="number" id="game-speed" value="10" onchange="updatePreview()">
        
        <button onclick="openLevels()">üìù –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–Ω–∏</button>
    </div>

    <div class="section">
        <h2>üèÜ –§–∏–¥–±–µ–∫</h2>
        <label>–¢–µ–∫—Å—Ç –ø–æ–±–µ–¥—ã</label>
        <input type="text" id="win-text" value="CONGRATULATIONS!" onchange="updatePreview()">
        <label>–¢–µ–∫—Å—Ç –ø—Ä–æ–≤–∞–ª–∞</label>
        <input type="text" id="lose-text" value="GAME OVER" onchange="updatePreview()">
    </div>

    <button onclick="downloadGame()">üíæ –°–ö–ê–ß–ê–¢–¨ –ò–ì–†–£ (HTML)</button>
</div>

<div id="preview-side">
    <div class="toolbar">
        <span>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (Live)</span>
        <button style="width:auto; padding:5px 15px;" onclick="updatePreview()">–û–±–Ω–æ–≤–∏—Ç—å</button>
    </div>
    <iframe id="game-frame"></iframe>
</div>

<div id="modal">
    <div class="modal-content">
        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω–µ–π –∏ –≤–æ–ø—Ä–æ—Å–æ–≤</h2>
        <div id="levels-container"></div>
        <button class="secondary" onclick="addLevel()">+ –î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å</button>
        <button style="margin-top:20px" onclick="closeLevels()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<script>
    // --- –î–ê–ù–ù–´–ï –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ ---
    let gameLevels = [
        {
            name: "Level 1",
            questions: [
                {text: "I ____ ready.", answers: ["am", "is", "are"], correct: 0},
                {text: "She ____ a cat.", answers: ["have", "has", "be"], correct: 1}
            ]
        }
    ];

    const frame = document.getElementById('game-frame');

    function updatePreview() {
        const config = {
            bg: document.getElementById('bg-select').value === 'custom' ? document.getElementById('custom-bg').value : document.getElementById('bg-select').value,
            char: document.getElementById('char-select').value,
            mainColor: document.getElementById('main-color').value,
            fontColor: document.getElementById('font-color').value,
            fontSize: document.getElementById('font-size').value + 'px',
            neon: document.getElementById('neon-toggle').value === 'yes' ? '0 0 18px ' + document.getElementById('main-color').value : 'none',
            speed: document.getElementById('game-speed').value,
            winTxt: document.getElementById('win-text').value,
            loseTxt: document.getElementById('lose-text').value,
            levels: JSON.stringify(gameLevels)
        };

        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–æ–¥ –∏–≥—Ä—ã –Ω–∞ –ª–µ—Ç—É
        const source = `
            <!doctype html>
            <html>
            <head>
                <style>
                    :root { --neon-main: ${config.mainColor}; --danger: #ff3b3b; }
                    body { margin:0; overflow:hidden; font-family: Arial; background:#0a1730; color: ${config.fontColor}; font-size: ${config.fontSize}; }
                    #BG { position:absolute; inset:0; background:url("${config.bg}") center/cover no-repeat; }
                    #QUESTION { position:absolute; top:30px; width:100%; text-align:center; z-index:20; }
                    #TIMER { 
                        position:absolute; top:80px; left:50%; transform:translateX(-50%);
                        width:80px; height:80px; border-radius:50%; display:flex; align-items:center; justify-content:center;
                        background: rgba(0,0,0,0.5); border:3px solid var(--neon-main);
                        box-shadow: ${config.neon}; font-weight:900;
                    }
                    #FROG {
                        position:absolute; left:160px; top:50%; width:100px; height:100px;
                        background:url("${config.char}") no-repeat center/contain;
                        transform:translate(-50%,-65%); z-index:15;
                    }
                    /* ... (–¢—É—Ç –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏–≥—Ä—ã, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –∫–æ–Ω—Ñ–∏–≥) ... */
                </style>
            </head>
            <body>
                <div id="BG"></div>
                <div id="QUESTION">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞...</div>
                <div id="TIMER">00:${config.speed}</div>
                <div id="FROG"></div>
                <script>
                    const LEVELS = ${config.levels};
                    document.getElementById('QUESTION').innerText = LEVELS[0].questions[0].text;
                <\/script>
            </body>
            </html>
        `;

        const blob = new Blob([source], {type: 'text/html'});
        frame.src = URL.createObjectURL(blob);
    }

    // --- –õ–û–ì–ò–ö–ê –ú–û–î–ê–õ–ö–ò ---
    function openLevels() { document.getElementById('modal').style.display = 'flex'; renderLevels(); }
    function closeLevels() { document.getElementById('modal').style.display = 'none'; updatePreview(); }

    function renderLevels() {
        const container = document.getElementById('levels-container');
        container.innerHTML = gameLevels.map((l, lIdx) => `
            <div class="section" style="background:#1e293b; padding:10px; border-radius:10px">
                <input type="text" value="${l.name}" onchange="gameLevels[${lIdx}].name=this.value">
                ${l.questions.map((q, qIdx) => `
                    <div class="q-item">
                        <input type="text" value="${q.text}" placeholder="–í–æ–ø—Ä–æ—Å" onchange="gameLevels[${lIdx}].questions[${qIdx}].text=this.value">
                        <input type="text" value="${q.answers.join(', ')}" placeholder="–û—Ç–≤–µ—Ç—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)" onchange="gameLevels[${lIdx}].questions[${qIdx}].answers=this.value.split(',')">
                    </div>
                `).join('')}
                <button class="secondary" onclick="addQuestion(${lIdx})">+ –í–æ–ø—Ä–æ—Å</button>
            </div>
        `).join('');
    }

    function addLevel() { gameLevels.push({name: "New Level", questions: []}); renderLevels(); }
    function addQuestion(idx) { gameLevels[idx].questions.push({text: "", answers: ["", "", ""], correct: 0}); renderLevels(); }

    // --- –ó–ê–ì–†–£–ó–ö–ê ---
    function downloadGame() {
        const html = frame.src; // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç—É—Ç –±—É–¥–µ—Ç —Å–±–æ—Ä–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–¥–∞
        const link = document.createElement('a');
        link.href = frame.src;
        link.download = 'LeapAndLearn_Game.html';
        link.click();
    }

    // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
    updatePreview();
</script>

</body>
</html>
