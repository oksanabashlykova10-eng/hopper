<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Leap & Learn ‚Äî Editor (Genially)</title>

<style>
  :root{
    --text:#eaf0ff;
    --muted:#a9b4d6;
    --accent:#7cf9ff;
    --shadow: 0 18px 60px rgba(0,0,0,.55);
    --radius: 18px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text);
    background: radial-gradient(1200px 800px at 20% 10%, rgba(124,249,255,.12), transparent 60%),
                radial-gradient(1200px 800px at 80% 90%, rgba(255,59,59,.10), transparent 60%),
                linear-gradient(180deg, #050612, #070817);
    overflow:hidden;
  }

  header{
    display:flex; align-items:center; justify-content:space-between;
    padding:14px 16px;
    border-bottom:1px solid rgba(124,249,255,.12);
    background: linear-gradient(180deg, rgba(14,19,48,.75), rgba(8,10,24,.25));
    backdrop-filter: blur(10px);
  }
  header .title{display:flex; gap:10px; align-items:center;}
  .badge{
    padding:6px 10px; border-radius:999px;
    font-weight:800; letter-spacing:.4px; font-size:12px;
    background: rgba(124,249,255,.12);
    border:1px solid rgba(124,249,255,.25);
    color:var(--accent);
    box-shadow: 0 0 22px rgba(124,249,255,.12);
  }
  h1{margin:0;font-size:16px;font-weight:900;letter-spacing:.2px}
  .sub{color:var(--muted); font-size:12px}

  .wrap{
    height: calc(100% - 62px);
    display:grid;
    grid-template-columns: 460px 1fr;
    gap:14px;
    padding:14px;
  }

  .left, .right{
    border-radius: var(--radius);
    background: linear-gradient(180deg, rgba(14,19,48,.65), rgba(11,16,39,.35));
    border:1px solid rgba(124,249,255,.12);
    box-shadow: var(--shadow);
    overflow:hidden;
    min-height:0;
  }
  .left{display:flex; flex-direction:column;}
  .left .scroll{padding:12px; overflow:auto; height:100%;}

  .section{
    border:1px solid rgba(124,249,255,.12);
    background: rgba(7,9,18,.35);
    border-radius:16px;
    padding:10px;
    margin-bottom:10px;
  }
  .section h2{
    margin:0 0 8px 0;
    font-size:13px;
    letter-spacing:.2px;
    display:flex; align-items:center; justify-content:space-between;
  }
  .hint{color:var(--muted); font-size:11px; line-height:1.25}

  .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
  .grid3{display:grid; grid-template-columns: 1fr 1fr 1fr; gap:10px}
  label{display:block; font-size:12px; color:var(--muted); margin:0 0 6px}

  input[type="text"], input[type="number"], textarea, select{
    width:100%;
    padding:10px 10px;
    border-radius:12px;
    border:1px solid rgba(124,249,255,.16);
    background: rgba(6,8,18,.6);
    color: var(--text);
    outline:none;
  }
  input[type="color"]{
    width:100%;
    height:42px;
    border-radius:12px;
    border:1px solid rgba(124,249,255,.16);
    background: rgba(6,8,18,.6);
    padding:6px;
  }

  .check{
    display:flex; gap:10px; align-items:center;
    padding:10px;
    border-radius:12px;
    border:1px solid rgba(124,249,255,.12);
    background: rgba(6,8,18,.45);
    color:var(--text);
  }
  .check input{transform: scale(1.15)}
  .btnbar{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px;}
  button{
    cursor:pointer; border:none;
    padding:10px 12px;
    border-radius:14px;
    font-weight:900;
    color:#081018;
    background: linear-gradient(180deg, rgba(124,249,255,1), rgba(124,249,255,.7));
    box-shadow: 0 0 25px rgba(124,249,255,.18);
  }
  button.secondary{
    color:var(--text);
    background: rgba(6,8,18,.55);
    border:1px solid rgba(124,249,255,.18);
    box-shadow:none;
  }
  button.danger{
    color:#13060a;
    background: linear-gradient(180deg, rgba(255,59,59,1), rgba(255,59,59,.65));
    box-shadow: 0 0 25px rgba(255,59,59,.16);
  }

  .lvlCard{
    border:1px solid rgba(124,249,255,.12);
    border-radius:14px;
    background: rgba(0,0,0,.18);
    padding:10px;
    margin-top:10px;
  }
  .lvlHead{
    display:flex; justify-content:space-between; align-items:center;
    font-weight:1000; font-size:12px; color:var(--accent);
    margin-bottom:8px;
  }
  .lvlNote{font-size:11px; color:var(--muted)}

  .right{display:flex; flex-direction:column; min-height:0;}
  .rightTop{
    padding:10px 12px;
    border-bottom:1px solid rgba(124,249,255,.12);
    display:flex; justify-content:space-between; align-items:center;
  }
  .rightTop .title2{font-weight:1000; letter-spacing:.2px}
  .previewWrap{flex:1; min-height:0; padding:12px;}
  iframe{
    width:100%;
    height:100%;
    border:1px solid rgba(124,249,255,.16);
    border-radius:16px;
    background: rgba(0,0,0,.25);
  }
  .out{
    padding:12px;
    border-top:1px solid rgba(124,249,255,.12);
    background: rgba(7,9,18,.35);
  }
  .out textarea{min-height:170px}

  .toast{
    position:fixed; left:50%; bottom:14px; transform:translateX(-50%);
    padding:10px 12px;
    border-radius:999px;
    background: rgba(6,8,18,.75);
    border:1px solid rgba(124,249,255,.20);
    color:var(--text);
    box-shadow: var(--shadow);
    opacity:0; pointer-events:none;
    transition:.22s;
  }
  .toast.show{opacity:1; transform:translateX(-50%) translateY(-4px)}
</style>
</head>

<body>
<header>
  <div class="title">
    <span class="badge">EDITOR</span>
    <div>
      <h1>Leap & Learn</h1>
      <div class="sub">–†–µ–¥–∞–∫—Ç–æ—Ä ‚Üí –∂–∏–≤–æ–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä ‚Üí iframe(srcdoc) –¥–ª—è Genially</div>
    </div>
  </div>
  <div class="sub">GitHub Pages ‚Üí Genially</div>
</header>

<div class="wrap">
  <aside class="left">
    <div class="scroll">

      <div class="section">
        <h2>–ë–∞–∑–æ–≤—ã–µ</h2>
        <div class="grid2">
          <div>
            <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π</label>
            <input id="levels" type="number" min="1" max="30" value="3">
          </div>
          <div>
            <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å: —Å–µ–∫—É–Ω–¥ (t1=t2=t3)</label>
            <input id="seconds" type="number" min="3" max="60" value="10">
          </div>
        </div>
        <div class="hint" style="margin-top:8px">
          –ù–∏–∂–µ –ø–æ—è–≤—è—Ç—Å—è –æ–∫–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è: –≤–æ–ø—Ä–æ—Å + 3 –æ—Ç–≤–µ—Ç–∞ (1-–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π).
        </div>
      </div>

      <div class="section">
        <h2>–ó–∞–¥–∞–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º</h2>
        <div class="hint">1 ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, 2‚Äì3 ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ.</div>
        <div id="levelsEditor"></div>
      </div>

      <div class="section">
        <h2>–¶–≤–µ—Ç–∞ –∏ –Ω–µ–æ–Ω</h2>
        <div class="grid3">
          <div>
            <label>–ù–µ–æ–Ω (main)</label>
            <input id="neonMain" type="color" value="#7cf9ff">
          </div>
          <div>
            <label>Danger</label>
            <input id="dangerColor" type="color" value="#ff3b3b">
          </div>
          <div>
            <label>Win</label>
            <input id="winColor" type="color" value="#ffe44d">
          </div>
        </div>
        <div class="grid2" style="margin-top:10px">
          <div class="check">
            <input id="neonOn" type="checkbox" checked>
            <div>
              <div style="font-weight:1000">–ù–µ–æ–Ω–æ–≤–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞</div>
              <div class="hint">–í—ã–∫–ª—é—á–∏ ‚Äî —É–±–µ—Ä—É—Ç—Å—è glow/—Ç–µ–Ω–∏</div>
            </div>
          </div>
          <div>
            <label>–¶–≤–µ—Ç –≤–æ–ø—Ä–æ—Å–∞</label>
            <input id="questionColor" type="color" value="#000000">
          </div>
        </div>
      </div>

      <div class="section">
        <h2>–§–æ–Ω / –ø–µ—Ä—Å–æ–Ω–∞–∂ / –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞</h2>
        <div class="grid2">
          <div>
            <label>–§–æ–Ω (–ª–æ–∫–∞—Ü–∏—è)</label>
            <select id="bgPreset">
              <option value="river">–†–µ–∫–∞</option>
              <option value="lava">–õ–∞–≤–∞</option>
              <option value="swamp">–ë–æ–ª–æ—Ç–æ</option>
              <option value="custom">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–π</option>
            </select>
            <input id="bgUpload" type="file" accept="image/*" style="margin-top:8px; display:none">
          </div>
          <div>
            <label>–ü–µ—Ä—Å–æ–Ω–∞–∂</label>
            <select id="heroPreset">
              <option value="frog">–õ—è–≥—É—à–∫–∞</option>
              <option value="chameleon">–•–∞–º–µ–ª–µ–æ–Ω</option>
              <option value="lizard">–Ø—â–µ—Ä–∏—Ü–∞</option>
              <option value="custom">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ–µ–≥–æ</option>
            </select>
            <input id="heroUpload" type="file" accept="image/*" style="margin-top:8px; display:none">
          </div>
        </div>

        <div style="margin-top:10px">
          <label>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</label>
          <select id="platformPreset">
            <option value="p1">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ 1 (URL)</option>
            <option value="p2">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ 2 (URL)</option>
            <option value="p3">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ 3 (URL)</option>
            <option value="custom">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ—é</option>
          </select>
          <input id="platformUpload" type="file" accept="image/*" style="margin-top:8px; display:none">

          <div class="grid3" style="margin-top:10px">
            <div><label>URL –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã 1</label><input id="plat1" type="text" placeholder="—Å—Å—ã–ª–∫–∞ #1"></div>
            <div><label>URL –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã 2</label><input id="plat2" type="text" placeholder="—Å—Å—ã–ª–∫–∞ #2"></div>
            <div><label>URL –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã 3</label><input id="plat3" type="text" placeholder="—Å—Å—ã–ª–∫–∞ #3"></div>
          </div>
        </div>
      </div>

      <div class="section">
        <h2>–ó–≤—É–∫–∏</h2>
        <div class="grid2">
          <div>
            <label>–ü—Ä–∞–≤–∏–ª—å–Ω–æ (URL –∏–ª–∏ upload)</label>
            <input id="sndOkUrl" type="text" placeholder="https://... –∏–ª–∏ –ø—É—Å—Ç–æ">
            <input id="sndOkFile" type="file" accept="audio/*" style="margin-top:8px">
          </div>
          <div>
            <label>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (URL –∏–ª–∏ upload)</label>
            <input id="sndBadUrl" type="text" placeholder="https://... –∏–ª–∏ –ø—É—Å—Ç–æ">
            <input id="sndBadFile" type="file" accept="audio/*" style="margin-top:8px">
          </div>
        </div>
        <div class="grid2" style="margin-top:10px">
          <div>
            <label>–ü–æ–±–µ–¥–∞ (URL –∏–ª–∏ upload)</label>
            <input id="sndWinUrl" type="text" placeholder="https://... –∏–ª–∏ –ø—É—Å—Ç–æ">
            <input id="sndWinFile" type="file" accept="audio/*" style="margin-top:8px">
          </div>
          <div>
            <label>–ü—Ä–æ–≤–∞–ª (URL –∏–ª–∏ upload)</label>
            <input id="sndLoseUrl" type="text" placeholder="https://... –∏–ª–∏ –ø—É—Å—Ç–æ">
            <input id="sndLoseFile" type="file" accept="audio/*" style="margin-top:8px">
          </div>
        </div>
      </div>

      <div class="section">
        <h2>–î–µ–π—Å—Ç–≤–∏—è</h2>
        <div class="btnbar">
          <button id="copyBtn">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å iframe –∏–≥—Ä—ã</button>
          <button class="secondary" id="resetBtn">–°–±—Ä–æ—Å–∏—Ç—å (–¥–µ–º–æ)</button>
          <button class="danger" id="forceReloadBtn">–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å</button>
        </div>
      </div>

    </div>
  </aside>

  <section class="right">
    <div class="rightTop">
      <div class="title2">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
      <div class="sub">–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</div>
    </div>
    <div class="previewWrap">
      <iframe id="preview" sandbox="allow-scripts"></iframe>
    </div>

    <div class="out">
      <label>–ì–æ—Ç–æ–≤—ã–π –∫–æ–¥ iframe (–≤—Å—Ç–∞–≤—å –≤ Genially)</label>
      <textarea id="iframeOut" readonly></textarea>
      <div class="hint" style="margin-top:8px">
        –≠—Ç–æ –∏ –µ—Å—Ç—å ‚Äú–∫–æ–Ω–µ—á–Ω–∞—è —Å—Å—ã–ª–∫–∞‚Äù: —Ç—ã –∫–æ–ø–∏—Ä—É–µ—à—å iframe (srcdoc) –æ—Ç—Å—é–¥–∞ –∏ –≤—Å—Ç–∞–≤–ª—è–µ—à—å –≤ Genially.
      </div>
    </div>
  </section>
</div>

<div class="toast" id="toast">–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ</div>

<script>
/* presets */
const PRESET_BACKGROUNDS = {
  river: "https://img.genially.com/67961b32a116fb001568a75e/c0c9010f-c3dd-42c1-b7c1-65024fa3aec6.png",
  lava:  "https://img.genially.com/67961b32a116fb001568a75e/fa2ab459-fec9-4ccd-97e3-254427b4ade0.png",
  swamp: "https://img.genially.com/67961b32a116fb001568a75e/02b52ad4-9d31-4b21-a305-8fec6e8a4487.png"
};
const PRESET_HERO = {
  frog: "https://img.genially.com/67961b32a116fb001568a75e/3074df22-5c73-4ad2-b0b2-491c6fc247f3.png",
  chameleon: "https://img.genially.com/67961b32a116fb001568a75e/74b56fcf-5354-43dd-9c9a-f50facc9a9bf.png",
  lizard: "https://img.genially.com/67961b32a116fb001568a75e/0feda2a1-485a-4654-8640-bf1adcc9f9ec.png"
};

const $ = (id)=>document.getElementById(id);
const ui = {
  levels: $('levels'),
  seconds: $('seconds'),
  levelsEditor: $('levelsEditor'),

  neonMain: $('neonMain'),
  dangerColor: $('dangerColor'),
  winColor: $('winColor'),
  neonOn: $('neonOn'),
  questionColor: $('questionColor'),

  bgPreset: $('bgPreset'),
  bgUpload: $('bgUpload'),
  heroPreset: $('heroPreset'),
  heroUpload: $('heroUpload'),

  platformPreset: $('platformPreset'),
  platformUpload: $('platformUpload'),
  plat1: $('plat1'),
  plat2: $('plat2'),
  plat3: $('plat3'),

  sndOkUrl: $('sndOkUrl'),
  sndBadUrl: $('sndBadUrl'),
  sndWinUrl: $('sndWinUrl'),
  sndLoseUrl: $('sndLoseUrl'),
  sndOkFile: $('sndOkFile'),
  sndBadFile: $('sndBadFile'),
  sndWinFile: $('sndWinFile'),
  sndLoseFile: $('sndLoseFile'),

  preview: $('preview'),
  iframeOut: $('iframeOut'),
  copyBtn: $('copyBtn'),
  resetBtn: $('resetBtn'),
  forceReloadBtn: $('forceReloadBtn'),
  toast: $('toast'),
};

let customBgDataUrl="", customHeroDataUrl="", customPlatformDataUrl="";
let sndData = { ok:"", bad:"", win:"", lose:"" };

function toast(msg){
  ui.toast.textContent = msg;
  ui.toast.classList.add('show');
  setTimeout(()=>ui.toast.classList.remove('show'), 1100);
}
function clampInt(v,min,max,def){
  const n = parseInt(v,10);
  if(Number.isNaN(n)) return def;
  return Math.max(min, Math.min(max, n));
}
function readFileAsDataURL(file){
  return new Promise((resolve,reject)=>{
    const fr=new FileReader();
    fr.onload=()=>resolve(fr.result);
    fr.onerror=()=>reject(fr.error);
    fr.readAsDataURL(file);
  });
}
async function handleSoundFile(which, input){
  const f = input.files && input.files[0];
  sndData[which] = f ? await readFileAsDataURL(f) : "";
  rebuild();
}

/* –í srcdoc –Ω–µ —Ç—Ä–æ–≥–∞–µ–º < >, –∏–Ω–∞—á–µ –∏–≥—Ä–∞ —Å—Ç–∞–Ω–µ—Ç —Ç–µ–∫—Å—Ç–æ–º. –≠–∫—Ä–∞–Ω–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ & –∏ ' */
function escapeForSingleQuotedAttr(s){
  return s.replace(/&/g,'&amp;').replace(/'/g,'&#39;');
}
function escapeHtmlAttr(s){
  return String(s)
    .replace(/&/g,'&amp;')
    .replace(/"/g,'&quot;')
    .replace(/</g,'&lt;')
    .replace(/>/g,'&gt;');
}

/* ===== –∑–∞–¥–∞–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º: 1 —É—Ä–æ–≤–µ–Ω—å = 1 –æ–∫–Ω–æ (–∏ 1 –≤–æ–ø—Ä–æ—Å/3 –æ—Ç–≤–µ—Ç–∞) ===== */
function buildLevelsEditor(){
  const n = clampInt(ui.levels.value, 1, 30, 3);

  // —Å–æ—Ö—Ä–∞–Ω–∏–º —Ç–æ, —á—Ç–æ —É–∂–µ –≤–≤–µ–¥–µ–Ω–æ
  const existing = [];
  ui.levelsEditor.querySelectorAll('[data-lvl]').forEach(card=>{
    const idx = parseInt(card.getAttribute('data-lvl'),10);
    existing[idx-1] = {
      name: card.querySelector('.lvlname').value,
      q: card.querySelector('.q').value,
      a1: card.querySelector('.a1').value,
      a2: card.querySelector('.a2').value,
      a3: card.querySelector('.a3').value
    };
  });

  ui.levelsEditor.innerHTML = "";
  for(let i=1;i<=n;i++){
    const data = existing[i-1] || {
      name:`Level ${i}`,
      q:`Question for level ${i}`,
      a1:`Correct`,
      a2:`Wrong A`,
      a3:`Wrong B`
    };

    const wrap=document.createElement('div');
    wrap.className='lvlCard';
    wrap.setAttribute('data-lvl', String(i));
    wrap.innerHTML = `
      <div class="lvlHead">
        <div>–£—Ä–æ–≤–µ–Ω—å ${i}</div>
        <div class="lvlNote">1‚úÖ 2‚ùå 3‚ùå</div>
      </div>

      <div>
        <label>–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è</label>
        <input class="lvlname" type="text" value="${escapeHtmlAttr(data.name)}">
      </div>

      <div style="margin-top:10px">
        <label>–í–æ–ø—Ä–æ—Å</label>
        <input class="q" type="text" value="${escapeHtmlAttr(data.q)}">
      </div>

      <div class="grid3" style="margin-top:10px">
        <div><label>–û—Ç–≤–µ—Ç 1 (‚úÖ)</label><input class="a1" type="text" value="${escapeHtmlAttr(data.a1)}"></div>
        <div><label>–û—Ç–≤–µ—Ç 2 (‚ùå)</label><input class="a2" type="text" value="${escapeHtmlAttr(data.a2)}"></div>
        <div><label>–û—Ç–≤–µ—Ç 3 (‚ùå)</label><input class="a3" type="text" value="${escapeHtmlAttr(data.a3)}"></div>
      </div>
    `;
    ui.levelsEditor.appendChild(wrap);
  }

  ui.levelsEditor.querySelectorAll('input').forEach(inp=>{
    inp.addEventListener('input', rebuild);
    inp.addEventListener('change', rebuild);
  });
}

function readLevelsData(){
  const cards = [...ui.levelsEditor.querySelectorAll('[data-lvl]')];
  return cards.map(card=>{
    return {
      name: card.querySelector('.lvlname').value.trim() || "Level",
      questions: [{
        text: card.querySelector('.q').value.trim() || "‚Ä¶",
        answers: [
          card.querySelector('.a1').value.trim() || "‚Ä¶",
          card.querySelector('.a2').value.trim() || "‚Ä¶",
          card.querySelector('.a3').value.trim() || "‚Ä¶"
        ],
        correct: 0
      }]
    };
  });
}

/* uploads */
ui.bgPreset.addEventListener('change', ()=>{
  ui.bgUpload.style.display = (ui.bgPreset.value==='custom') ? 'block' : 'none';
  rebuild();
});
ui.bgUpload.addEventListener('change', async ()=>{
  const f=ui.bgUpload.files && ui.bgUpload.files[0];
  customBgDataUrl = f ? await readFileAsDataURL(f) : "";
  rebuild();
});

ui.heroPreset.addEventListener('change', ()=>{
  ui.heroUpload.style.display = (ui.heroPreset.value==='custom') ? 'block' : 'none';
  rebuild();
});
ui.heroUpload.addEventListener('change', async ()=>{
  const f=ui.heroUpload.files && ui.heroUpload.files[0];
  customHeroDataUrl = f ? await readFileAsDataURL(f) : "";
  rebuild();
});

ui.platformPreset.addEventListener('change', ()=>{
  ui.platformUpload.style.display = (ui.platformPreset.value==='custom') ? 'block' : 'none';
  rebuild();
});
ui.platformUpload.addEventListener('change', async ()=>{
  const f=ui.platformUpload.files && ui.platformUpload.files[0];
  customPlatformDataUrl = f ? await readFileAsDataURL(f) : "";
  rebuild();
});

ui.sndOkFile.addEventListener('change', ()=>handleSoundFile('ok', ui.sndOkFile));
ui.sndBadFile.addEventListener('change', ()=>handleSoundFile('bad', ui.sndBadFile));
ui.sndWinFile.addEventListener('change', ()=>handleSoundFile('win', ui.sndWinFile));
ui.sndLoseFile.addEventListener('change', ()=>handleSoundFile('lose', ui.sndLoseFile));

function getConfig(){
  const levels = clampInt(ui.levels.value, 1, 30, 3);
  const seconds = clampInt(ui.seconds.value, 3, 60, 10);

  let levelsData = readLevelsData();
  while(levelsData.length < levels){
    const i = levelsData.length+1;
    levelsData.push({
      name:`Level ${i}`,
      questions:[{text:`Question for level ${i}`,answers:["Correct","Wrong A","Wrong B"],correct:0}]
    });
  }
  levelsData.length = levels;

  const bgUrl = (ui.bgPreset.value==='custom')
    ? (customBgDataUrl || PRESET_BACKGROUNDS.river)
    : PRESET_BACKGROUNDS[ui.bgPreset.value];

  const heroUrl = (ui.heroPreset.value==='custom')
    ? (customHeroDataUrl || PRESET_HERO.frog)
    : PRESET_HERO[ui.heroPreset.value];

  const p1=ui.plat1.value.trim(), p2=ui.plat2.value.trim(), p3=ui.plat3.value.trim();
  let platformUrl="";
  if(ui.platformPreset.value==='custom') platformUrl = customPlatformDataUrl || p1 || p2 || p3 || "";
  if(ui.platformPreset.value==='p1') platformUrl = p1 || p2 || p3 || "";
  if(ui.platformPreset.value==='p2') platformUrl = p2 || p1 || p3 || "";
  if(ui.platformPreset.value==='p3') platformUrl = p3 || p1 || p2 || "";

  // fallback (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –ø—É—Å—Ç–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã)
  if(!platformUrl){
    platformUrl = "https://img.genially.com/67961b32a116fb001568a75e/ed6c6e82-953b-43d4-947d-e46227b760f0.png";
  }

  return {
    title: "Leap & Learn",
    levels,
    seconds,
    levelsData,
    colors:{
      neonMain: ui.neonMain.value,
      danger: ui.dangerColor.value,
      win: ui.winColor.value,
      question: ui.questionColor.value
    },
    neonOn: !!ui.neonOn.checked,
    assets:{ bg:bgUrl, hero:heroUrl, platform:platformUrl },
    sounds:{
      ok:   ui.sndOkUrl.value.trim()   || sndData.ok || "",
      bad:  ui.sndBadUrl.value.trim()  || sndData.bad || "",
      win:  ui.sndWinUrl.value.trim()  || sndData.win || "",
      lose: ui.sndLoseUrl.value.trim() || sndData.lose || ""
    }
  };
}

/* ====== IMPORTANT FIX: –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∏–≥—Ä—É –∏ –≠–ö–†–ê–ù–ò–†–£–ï–ú </script> –∫–∞–∫ <\/script> ====== */
function buildGameSrcdoc(cfg){
  const CFG_JSON = JSON.stringify(cfg);

  const html = `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Leap & Learn</title>

<style>
:root{
  --neon-main:${cfg.colors.neonMain};
  --danger:${cfg.colors.danger};
  --win:${cfg.colors.win};
}
html,body{margin:0;width:100%;height:100%;overflow:hidden;font-family:Arial;background:#0a1730}

/* GAME */
#GAME{position:relative;width:100%;height:100%}
#GAME.shake{animation:shake .25s}
@keyframes shake{
  0%{transform:translate(0)}
  25%{transform:translate(-4px,3px)}
  50%{transform:translate(4px,-3px)}
  75%{transform:translate(-3px,2px)}
  100%{transform:translate(0)}
}

/* BACKGROUND */
#BG{position:absolute;inset:0;z-index:0;background:url("${cfg.assets.bg}") center/cover no-repeat}

/* UI */
#QUESTION{position:absolute;top:26px;width:100%;text-align:center;font-size:26px;z-index:20;color:${cfg.colors.question};text-shadow:0 2px 0 rgba(0,0,0,.35)}
#TIMER{
  position:absolute;top:70px;left:50%;transform:translateX(-50%);
  width:80px;height:80px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  background:#fff;border:2px solid var(--neon-main);
  box-shadow:${cfg.neonOn ? "0 0 18px var(--neon-main)" : "none"};
  z-index:20;font-weight:900;color:#053149;
}
#TIMER.danger{
  border-color:var(--danger);color:var(--danger);
  box-shadow:${cfg.neonOn ? "0 0 25px var(--danger)" : "none"};
  animation:pulse .8s infinite;
}
@keyframes pulse{50%{transform:translateX(-50%) scale(1.12)}}
#LIVES{position:absolute;top:30px;right:30px;font-size:26px;z-index:20}
#SCORE{position:absolute;top:30px;left:30px;font-size:20px;font-weight:900;z-index:20;color:#fff;text-shadow:0 2px 0 rgba(0,0,0,.35)}

/* COMBO */
#COMBO{
  position:absolute;top:165px;left:50%;transform:translateX(-50%);
  z-index:20;padding:10px 16px;border-radius:18px;
  background:rgba(255,255,255,.88);
  border:2px solid var(--neon-main);
  box-shadow:${cfg.neonOn ? "0 0 18px rgba(124,249,255,.65), inset 0 0 14px rgba(124,249,255,.25)" : "none"};
  font-weight:900;color:#043149;display:none;gap:10px;align-items:center;
}
#COMBO.show{display:inline-flex}
#COMBO_BOLT{width:18px;height:18px;border-radius:6px;background:rgba(124,249,255,.25);box-shadow:${cfg.neonOn ? "0 0 14px rgba(124,249,255,.75)" : "none"};display:inline-block}
#COMBO.pulse{animation:comboPulse .55s ease}
@keyframes comboPulse{
  0%{transform:translateX(-50%) scale(1)}
  40%{transform:translateX(-50%) scale(1.12)}
  100%{transform:translateX(-50%) scale(1)}
}

/* BUTTONS */
.btn{
  padding:12px 34px;border-radius:16px;font-weight:900;
  background:#fff;border:2px solid var(--neon-main);
  box-shadow:${cfg.neonOn ? "0 0 15px var(--neon-main)" : "none"};
  cursor:pointer;color:#043149;
}
.btn:active{transform:translateY(1px)}
.btn.dark{
  background:rgba(255,255,255,.10);
  color:#eaf6ff;
  border:2px solid rgba(124,249,255,.55);
  box-shadow:${cfg.neonOn ? "0 0 16px rgba(124,249,255,.25)" : "none"};
}
#START.hide{display:none}

/* START SCREEN */
#START_SCREEN{
  position:absolute;inset:0;z-index:60;
  display:flex;align-items:center;justify-content:center;
  background:rgba(8,16,34,.92);
}
#START_CARD{
  width:min(760px, calc(100vw - 40px));
  border-radius:26px;
  background:linear-gradient(180deg, rgba(10,20,50,.92), rgba(5,10,25,.92));
  border:2px solid rgba(124,249,255,.75);
  box-shadow:${cfg.neonOn ? "0 0 30px rgba(124,249,255,.55), inset 0 0 24px rgba(124,249,255,.18)" : "none"};
  padding:18px 18px 16px;
  position:relative;overflow:hidden;color:#eaf6ff;
}
#START_TOP{position:relative;display:flex;align-items:center;gap:14px;padding:6px 6px 10px}
#START_ICON{
  width:64px;height:64px;flex:0 0 auto;
  background:url("${cfg.assets.hero}") no-repeat center/contain;
  filter:${cfg.neonOn ? "drop-shadow(0 0 14px rgba(124,249,255,.55))" : "none"};
}
#START_TITLE{font-weight:900;font-size:34px;color:#eaf6ff;text-shadow:${cfg.neonOn ? "0 0 18px rgba(124,249,255,.55)" : "none"};margin:0;line-height:1.05}
#START_SUB{margin:2px 0 0;color:#bfe9ff;opacity:.9;font-weight:700}
.panel{
  background:rgba(255,255,255,.08);
  border:1px solid rgba(124,249,255,.35);
  border-radius:18px;
  box-shadow:${cfg.neonOn ? "0 0 12px rgba(124,249,255,.18)" : "none"};
  padding:12px 12px 10px;margin-top:10px;
}
.panel h3{margin:0 0 8px;font-size:14px;letter-spacing:.08em;text-transform:uppercase;opacity:.9;color:#eaf6ff}
.rules{margin:0;color:#cfefff;font-weight:700;line-height:1.35;font-size:14px}
.rules li{margin:6px 0}
.kbd{display:inline-block;padding:2px 8px;border-radius:10px;border:1px solid rgba(124,249,255,.55);box-shadow:${cfg.neonOn ? "0 0 10px rgba(124,249,255,.22)" : "none"};background:rgba(255,255,255,.10);font-weight:900;color:#eaf6ff}
#START_BOTTOM{position:relative;display:flex;gap:10px;align-items:center;justify-content:space-between;margin-top:12px;flex-wrap:wrap}
.badge{
  display:inline-flex;align-items:center;gap:8px;
  padding:8px 12px;border-radius:16px;
  border:1px solid rgba(124,249,255,.35);
  box-shadow:${cfg.neonOn ? "0 0 12px rgba(124,249,255,.18)" : "none"};
  background:rgba(255,255,255,.08);
  color:#eaf6ff;font-weight:900;font-size:14px;
}
.badge small{opacity:.8;font-weight:900;color:#bfe9ff}
select{
  border-radius:14px;border:1px solid rgba(124,249,255,.45);
  background:rgba(255,255,255,.10);
  padding:8px 10px;font-weight:900;color:#eaf6ff;outline:none;
  box-shadow: inset 0 0 14px rgba(124,249,255,.10);
}
select option{color:#0b1630;background:#eaf6ff;font-weight:900}

/* END */
#END{position:absolute;inset:0;z-index:50;background:rgba(8,16,34,.92);display:none;align-items:center;justify-content:center;flex-direction:column;}
#END.show{display:flex}
#END_TEXT{font-size:58px;font-weight:900;margin:0 0 10px;animation:sway 2.5s ease-in-out infinite;text-align:center}
.win{color:var(--win);text-shadow:${cfg.neonOn ? "0 0 12px var(--win),0 0 34px var(--win)" : "none"}}
.lose{color:var(--danger);text-shadow:${cfg.neonOn ? "0 0 12px var(--danger),0 0 34px var(--danger)" : "none"}}
@keyframes sway{0%{transform:rotate(0deg)}25%{transform:rotate(2deg)}50%{transform:rotate(0deg)}75%{transform:rotate(-2deg)}100%{transform:rotate(0deg)}}
#LEVEL_NAME{margin:0 0 10px;color:#bfe9ff;font-weight:900;opacity:.95}

/* PLAYER */
#FROG{
  position:absolute;left:160px;top:50%;
  width:110px;height:110px;
  background:url("${cfg.assets.hero}") no-repeat center/contain;
  transform:translate(-50%,-65%);
  z-index:15;
  transition:transform .6s ease,opacity .6s ease;
  pointer-events:none;
}
#FROG.jump{transform:translate(-50%,-95%) scale(1.05)}
#FROG.sink{transform:translate(-50%,-10%) scale(.6);opacity:0}

/* PLATFORMS */
#PLATFORMS{position:absolute;inset:0;z-index:10}
.platform{position:absolute;width:150px;height:150px;transition:transform .5s,opacity .6s}
.lily{
  width:150px;height:150px;
  background:url("${cfg.assets.platform}") no-repeat center/contain;
  display:flex;align-items:center;justify-content:center;
  font-weight:900;color:#141414;
  text-shadow:0 2px 0 rgba(255,255,255,.65), 0 0 10px rgba(0,0,0,.35);
  animation:float 3.5s ease-in-out infinite;
  transition:transform .5s, filter .2s;
}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(6px)}}
.platform.answer{cursor:pointer}
.platform.fade{opacity:0}
.platform.fade .lily{transform:scale(.6)}
.platform.wrong .lily{filter:drop-shadow(0 0 18px red)}
</style>
</head>

<body>
<div id="GAME">
  <div id="BG"></div>
  <div id="SCORE">‚≠ê 0</div>
  <div id="QUESTION"></div>
  <div id="TIMER">00:10</div>
  <div id="COMBO"><span id="COMBO_BOLT"></span><span id="COMBO_TXT">COMBO x1.0</span></div>
  <div id="LIVES"></div>

  <div id="START" class="btn hide">‚ñ∂ Start</div>

  <div id="START_SCREEN">
    <div id="START_CARD">
      <div id="START_TOP">
        <div id="START_ICON"></div>
        <div>
          <h1 id="START_TITLE">Leap & Learn</h1>
          <div id="START_SUB">Fast quiz game ‚Ä¢ platforms, combos and speed</div>
        </div>
      </div>

      <div class="panel">
        <h3>How to Play</h3>
        <ul class="rules">
          <li>Pick the correct answer ‚Äî move forward.</li>
          <li>Timer difficulty: <span class="kbd">${cfg.seconds}s</span>.</li>
          <li>Choose a level (or all levels) and press <span class="kbd">START</span>.</li>
        </ul>
      </div>

      <div id="START_BOTTOM">
        <div class="badge">
          <span>Mode:</span>
          <select id="LEVEL"></select>
          <small>campaign or single</small>
        </div>

        <button id="START_BTN" class="btn">‚ñ∂ START</button>
      </div>
    </div>
  </div>

  <div id="END">
    <div id="END_TEXT"></div>
    <div id="LEVEL_NAME">Level 1</div>
    <button id="RETRY" class="btn">üîÅ Play again</button>
  </div>

  <div id="FROG"></div>
  <div id="PLATFORMS"></div>
</div>

<script>
const CFG = ${CFG_JSON};

const LEVELS = (CFG.levelsData||[]).map((lvl,i)=>({
  name: lvl.name || ("Level " + (i+1)),
  questions: (lvl.questions||[]).map(q=>({
    text: q.text || "‚Ä¶",
    answers: (q.answers||["‚Ä¶","‚Ä¶","‚Ä¶"]).slice(0,3),
    correct: 0
  }))
}));

const BASE=100, MULT=10, WRONG_PENALTY=80, LIVES_START=5;

const Q=QUESTION, T=TIMER, L=LIVES, S=SCORE, P=PLATFORMS;
const GAME=document.getElementById("GAME");
const FROG=document.getElementById("FROG");

const START_SCREEN=document.getElementById("START_SCREEN");
const START_BTN=document.getElementById("START_BTN");
const LEVEL=document.getElementById("LEVEL");

const END=document.getElementById("END");
const END_TEXT=document.getElementById("END_TEXT");
const LEVEL_NAME=document.getElementById("LEVEL_NAME");
const RETRY=document.getElementById("RETRY");

let QUESTIONS=[], q=0, lives=LIVES_START, score=0, started=false, locked=false;
let timer=null, timeLeft=0;
let levelIndex=0, campaignMode=false;

const ctx=new (AudioContext||webkitAudioContext)();
const userSnd = {
  ok:   CFG.sounds?.ok   ? new Audio(CFG.sounds.ok) : null,
  bad:  CFG.sounds?.bad  ? new Audio(CFG.sounds.bad) : null,
};
function playUser(a){
  try{ if(!a) return false; a.currentTime=0; a.play().catch(()=>{}); return true; }catch(e){ return false; }
}
function okSound(){
  if(playUser(userSnd.ok)) return;
  const t=ctx.currentTime;
  [523,659,784].forEach((f,i)=>{
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.frequency.value=f;
    g.gain.setValueAtTime(0,t+i*.12);
    g.gain.linearRampToValueAtTime(.25,t+i*.12+.05);
    g.gain.exponentialRampToValueAtTime(.001,t+i*.12+.4);
    o.connect(g);g.connect(ctx.destination);
    o.start(t+i*.12);o.stop(t+i*.12+.45);
  });
}
function badSound(){
  if(playUser(userSnd.bad)) return;
  const b=ctx.createBuffer(1,ctx.sampleRate*.9,ctx.sampleRate);
  const d=b.getChannelData(0);
  for(let i=0;i<d.length;i++)d[i]=(Math.random()*2-1)*(1-i/d.length);
  const s=ctx.createBufferSource(),g=ctx.createGain();
  g.gain.value=.6;
  s.buffer=b;
  s.connect(g);g.connect(ctx.destination);
  s.start();
}

function fmt(s){ return "00:"+String(s).padStart(2,"0"); }
function shuffle(arr){
  const a=arr.slice();
  for(let i=a.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [a[i],a[j]]=[a[j],a[i]];
  }
  return a;
}
function randomizeQuestion(qObj){
  const packs = qObj.answers.map((txt,idx)=>({txt, idx}));
  const shuffled = shuffle(packs);
  return {
    text:qObj.text,
    answers: shuffled.map(x=>x.txt),
    correct: shuffled.findIndex(x=>x.idx===qObj.correct)
  };
}
function buildQuestionsForLevel(idx){
  const lvl = LEVELS[idx] || LEVELS[0];
  QUESTIONS = shuffle((lvl.questions||[]).map(q=>randomizeQuestion(q)));
}

function buildModeSelect(){
  LEVEL.innerHTML="";
  const optAll=document.createElement("option");
  optAll.value="all";
  optAll.textContent = "All Levels (1‚Üí"+LEVELS.length+")";
  optAll.selected=true;
  LEVEL.appendChild(optAll);
  LEVELS.forEach((_,i)=>{
    const o=document.createElement("option");
    o.value=String(i);
    o.textContent="Level "+(i+1);
    LEVEL.appendChild(o);
  });
}

function startTimer(){
  clearInterval(timer);
  timeLeft = CFG.seconds || 10;
  T.classList.remove("danger");
  T.textContent=fmt(timeLeft);
  timer=setInterval(()=>{
    timeLeft--;
    if(timeLeft<=0){ clearInterval(timer); fail(); return; }
    T.textContent=fmt(timeLeft);
    if(timeLeft<=3) T.classList.add("danger");
  },1000);
}

function render(){
  locked=!started;
  P.innerHTML="";
  Q.textContent = QUESTIONS[q]?.text || "";
  L.textContent = "‚ù§Ô∏è".repeat(lives);
  S.textContent = "‚≠ê " + score;

  const STEP=190,y=innerHeight/2;
  const count=Math.ceil((innerWidth-160)/STEP)+4;

  for(let i=0;i<count;i++){
    const d=document.createElement("div");
    d.className="platform";
    d.style.left=160+STEP*i-75+"px";
    d.style.top=y-75+"px";

    const lily=document.createElement("div");
    lily.className="lily";

    if(i>0 && QUESTIONS[q] && i<=QUESTIONS[q].answers.length){
      lily.textContent=QUESTIONS[q].answers[i-1];
      d.classList.add("answer");
      d.onclick=()=>pick(i,d);
    }
    d.appendChild(lily);
    P.appendChild(d);
  }
}

function pick(i,el){
  if(!started||locked) return;
  locked=true;
  clearInterval(timer);
  const isCorrect = (i-1===QUESTIONS[q].correct);

  document.querySelectorAll(".platform")
    .forEach(p=>p.style.transform=\`translateX(\${-(el.offsetLeft+75-160)}px)\`);

  setTimeout(()=>{
    if(isCorrect){
      okSound();
      score += BASE + timeLeft*MULT;
      q++;
      if(q>=QUESTIONS.length) showEnd(true);
      else startRound();
    }else{
      fail();
    }
  }, 500);
}

function fail(){
  lives--;
  score = Math.max(0, score - WRONG_PENALTY);
  badSound();
  GAME.classList.add("shake"); setTimeout(()=>GAME.classList.remove("shake"),300);
  FROG.classList.add("sink");
  document.querySelectorAll(".platform").forEach(p=>p.classList.add("fade","wrong"));
  setTimeout(()=>{ lives<=0 ? showEnd(false) : startRound(); },900);
}

function startRound(){
  FROG.classList.remove("sink");
  locked=false;
  render();
  startTimer();
}

function showEnd(win){
  clearInterval(timer);
  END.classList.add("show");
  LEVEL_NAME.textContent = LEVELS[levelIndex]?.name || ("Level "+(levelIndex+1));
  END_TEXT.textContent = win ? "CONGRATULATIONS!" : "YOU LOST!";
  END_TEXT.className = win ? "win" : "lose";
}

function resetToMenu(){
  clearInterval(timer);
  END.classList.remove("show");
  START_SCREEN.style.display="flex";
  started=false; locked=false;
  q=0; lives=LIVES_START; score=0;
  render();
}

function startLevel(idx){
  levelIndex = Math.max(0, Math.min(LEVELS.length-1, idx));
  buildQuestionsForLevel(levelIndex);
  START_SCREEN.style.display="none";
  END.classList.remove("show");
  started=true;
  q=0; lives=LIVES_START; score=0;
  render();
  startRound();
}

START_BTN.onclick=()=>{
  ctx.resume();
  const v = LEVEL.value || "all";
  if(v==="all"){
    // –ø—Ä–æ—Å—Ç–∞—è –∫–∞–º–ø–∞–Ω–∏—è: —Å—Ç–∞—Ä—Ç—É–µ–º —Å 1 —É—Ä–æ–≤–Ω—è (–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –¥–∞–ª—å—à–µ –∫–∞–∫ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
    campaignMode=true;
    startLevel(0);
  }else{
    campaignMode=false;
    startLevel(parseInt(v,10)||0);
  }
};
RETRY.onclick=()=>resetToMenu();

window.addEventListener("resize", ()=>{ if(started && !END.classList.contains("show")) render(); });

buildModeSelect();
T.textContent=fmt(CFG.seconds||10);
render();
<\/script>
</body>
</html>`;

  // –ö–õ–Æ–ß–ï–í–û–ï: —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–π —Ç–µ–≥, —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä
  return html.replaceAll("</script>", "<\\/script>");
}

/* iframe output */
function buildIframeCode(srcdoc){
  const escaped = escapeForSingleQuotedAttr(srcdoc);
  return `<iframe style="width:100%;height:100%;border:0" srcdoc='${escaped}'></iframe>`;
}

/* rebuild */
let rebuildTimer=null;
function rebuild(){
  clearTimeout(rebuildTimer);
  rebuildTimer=setTimeout(()=>{
    const cfg=getConfig();
    const srcdoc=buildGameSrcdoc(cfg);
    ui.preview.srcdoc=srcdoc;
    ui.iframeOut.value=buildIframeCode(srcdoc);
  },80);
}

/* bind inputs */
function bindAuto(ids){
  ids.forEach(id=>{
    const el=$(id);
    el.addEventListener('input', rebuild);
    el.addEventListener('change', rebuild);
  });
}
bindAuto([
  'levels','seconds',
  'neonMain','dangerColor','winColor','neonOn','questionColor',
  'bgPreset','heroPreset','platformPreset',
  'plat1','plat2','plat3',
  'sndOkUrl','sndBadUrl','sndWinUrl','sndLoseUrl'
]);

ui.levels.addEventListener('input', ()=>{ buildLevelsEditor(); rebuild(); });
ui.levels.addEventListener('change', ()=>{ buildLevelsEditor(); rebuild(); });

ui.copyBtn.addEventListener('click', async ()=>{
  try{
    await navigator.clipboard.writeText(ui.iframeOut.value);
    toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ");
  }catch(e){
    ui.iframeOut.focus(); ui.iframeOut.select();
    document.execCommand('copy');
    toast("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ");
  }
});
ui.forceReloadBtn.addEventListener('click', ()=>{ rebuild(); toast("–ü–µ—Ä–µ—Å–æ–±—Ä–∞–Ω–æ"); });

ui.resetBtn.addEventListener('click', ()=>{
  ui.levels.value=3;
  ui.seconds.value=10;

  ui.neonMain.value="#7cf9ff";
  ui.dangerColor.value="#ff3b3b";
  ui.winColor.value="#ffe44d";
  ui.neonOn.checked=true;
  ui.questionColor.value="#000000";

  ui.bgPreset.value="river"; ui.bgUpload.style.display="none"; customBgDataUrl="";
  ui.heroPreset.value="frog"; ui.heroUpload.style.display="none"; customHeroDataUrl="";

  ui.platformPreset.value="p1"; ui.platformUpload.style.display="none"; customPlatformDataUrl="";
  ui.plat1.value="https://img.genially.com/67961b32a116fb001568a75e/ed6c6e82-953b-43d4-947d-e46227b760f0.png";
  ui.plat2.value="";
  ui.plat3.value="";

  ui.sndOkUrl.value=""; ui.sndBadUrl.value=""; ui.sndWinUrl.value=""; ui.sndLoseUrl.value="";
  ui.sndOkFile.value=""; ui.sndBadFile.value=""; ui.sndWinFile.value=""; ui.sndLoseFile.value="";
  sndData={ok:"",bad:"",win:"",lose:""};

  buildLevelsEditor();
  rebuild();
  toast("–°–±—Ä–æ—à–µ–Ω–æ");
});

/* show/hide upload fields */
ui.bgPreset.addEventListener('change', ()=>{ ui.bgUpload.style.display=(ui.bgPreset.value==='custom')?'block':'none'; });
ui.heroPreset.addEventListener('change', ()=>{ ui.heroUpload.style.display=(ui.heroPreset.value==='custom')?'block':'none'; });
ui.platformPreset.addEventListener('change', ()=>{ ui.platformUpload.style.display=(ui.platformPreset.value==='custom')?'block':'none'; });

/* init */
buildLevelsEditor();
rebuild();
</script>
</body>
</html>
